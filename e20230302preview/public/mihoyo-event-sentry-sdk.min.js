!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.EventSentrySdk=t():e.EventSentrySdk=t()}(self,(function(){return function(){var e={704:function(e,t,n){"use strict";var r=n(118),o=n.n(r),i=n(5),u=n.n(i),s=n(486),a=n.n(s),c=n(702),l=n.n(c),f=n(143),p=n.n(f),d=["name","time","interval","level","tags","extra"],y=["op","description"],v=function(){},x=function(){function e(){var t=this;a()(this,e),p()(this,"addCustomerMetric",(function(e){var n=e.name,r=e.time,i=e.interval,s=e.level,a=void 0===s?"info":s,c=e.tags,l=void 0===c?{}:c,f=e.extra,p=void 0===f?{}:f,y=u()(e,d),v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.floor(e/t),r=n*t,o=(n+1)*t;return"".concat(r,"_").concat(o)}(r,i);l["".concat(n,"-group")]=v,p[n]=r,t.captureMessage(o()({message:n,tags:l,extra:p,level:a},y))})),p()(this,"setMeasurement",(function(e){var t=e.name,n=e.value,r=e.unit;if(window.Sentry){var o=window.Sentry.getCurrentHub().getScope().getTransaction();o&&o.setMeasurement(t,n,r)}})),p()(this,"startTransaction",(function(e,t){if(window.Sentry)return window.Sentry.startTransaction(e,t);var n={finish:v};return{startChild:function(){return n},finish:v}})),p()(this,"createTransaction",(function(e,n){var r=t.startTransaction(e,n);window.Sentry&&window.Sentry.getCurrentHub().configureScope((function(e){return e.setSpan(r)}));var i={};return{createSpan:function(e){var t=e.op,n=e.description,s=void 0===n?"":n,a=u()(e,y);if(!t)throw new Error("请传入 span 名称 [op]");var c=r.startChild(o()({op:t,description:s},a));return i[t]=c,c},finishSpan:function(e){var t=i[e];t&&t.finish()},getSpan:function(e){return i[e]},finishTransaction:function(){return r.finish()}}}))}return l()(e,[{key:"captureMessage",value:function(e){var t=e||{},n=t.message,r=t.level,o=void 0===r?"error":r,i=t.tags,u=t.extra,s=t.context;window.Sentry&&window.Sentry.withScope((function(e){i&&e.setTags(i),u&&e.setExtras(u),s&&e.setContext("capture_message_customer",s),window.Sentry.captureMessage(n,o)}))}},{key:"captureException",value:function(e){var t=e||{},n=t.message,r=t.tags,o=t.extra,i=t.context;window.Sentry&&window.Sentry.withScope((function(e){r&&e.setTags(r),o&&e.setExtras(o),i&&e.setContext("capture_message_customer",i),window.Sentry.captureException(n)}))}},{key:"addBreadcrumb",value:function(e){window.Sentry&&window.Sentry.addBreadcrumb(e)}}]),e}();t.ZP=new x},576:function(e,t,n){"use strict";n.d(t,{Ch:function(){return D},ZP:function(){return E}});var r=n(118),o=n.n(r),i=n(486),u=n.n(i),s=n(702),a=n.n(s),c=n(143),l=n.n(c),f=n(158),p=n.n(f),d=n(547),y=n.n(d),v={"zh-cn":"中文","zh-tw":"繁体中文","en-us":"英语","id-id":"印尼语","th-th":"泰语","de-de":"德文","fr-fr":"法语","es-es":"西班牙语","pt-pt":"葡萄牙语","ru-ru":"俄罗斯语","ko-kr":"韩语","vi-vn":"越南语","ja-jp":"日语","tr-tr":"土耳其语","it-it":"意大利语"},x=function(e){return e.Wechat="微信",e.QQ="QQ",e.WeiBo="WeiBo",e.Xhs="小红书",e.BBS="米游社",e.Hoyolab="HoYolab",e}({}),h=n(925),w=n.n(h);var m=function(e){if(!e)return 0;var t=e.split(".").map((function(e){return Number(e)})),n=w()(t,4),r=n[0],o=n[1],i=n[2],u=void 0===i?0:i,s=n[3];return 1e3*r+100*o+u+.1*(void 0===s?0:s)},g="undefined"==typeof window;var b,S,_,U,O,j,M,P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},r=null,o=/[?&](.*?)=([^&#]*)/g;for(t&&(e=e.replace(/#.*?$/,"")),r=o.exec(e);r;){try{n[r[1]]=decodeURIComponent(r[2])}catch(e){try{n[r[1]]=unescape(r[2])}catch(e){n[r[1]]=r[2]}}r=o.exec(e)}return n},C=function(){return Boolean((e=navigator.userAgent.toLowerCase(),/mihoyo\/bh3/i.test(e)||P().gamewebview));var e},I="1.3.0";function k(){return function(e,t,n){var r=n.value;return n.value=function(){if(this.isInit){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}},n}}var D=(b=k(),S=k(),_=k(),U=k(),O=k(),j=k(),M=function(){function e(t){u()(this,e),l()(this,"isInit",!1),l()(this,"uuid",""),l()(this,"lang",void 0),l()(this,"$accountRoleUtil",void 0),l()(this,"user",{}),this.$accountRoleUtil=t.accountRoleUtil,this.lang=t.lang,g||(this.uuid=y().getUuid(),this.registerLoginEvent(),this.registerPaimonEventSentry(),this.init())}return a()(e,[{key:"init",value:function(){this.isInit||window.Sentry&&(this.isInit=!0,this.initContext(),console.log("MihoyoEventSentry@".concat(I," 初始化成功!")))}},{key:"setCulture",value:function(e){window.Sentry.setContext("culture",o()({locale:this.lang,display_name:v[this.lang]},e||{})),window.Sentry.setTags({lang:this.lang})}},{key:"setBrowser",value:function(e){var t={width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},n=t.width,r=t.height;window.Sentry.setContext("browser",o()({screen_resolution:"".concat(n,"x").concat(r),width:n,height:r,dpr:window.devicePixelRatio},e)),window.Sentry.setTags({"browser.width":n,"browser.height":r})}},{key:"setHost",value:function(e){var t=function(){for(var e=window.navigator.userAgent,t=0,n=[{name:x.Wechat,regex:/MicroMessenger\/([\d.]+)/i},{name:x.QQ,regex:/QQ\/([\d.]+)/i},{name:x.WeiBo,regex:/WeiBo__([\d.]+)/i},{name:x.Xhs,regex:/XiaoHongShu_([\d.]+)_Build/i},{name:x.BBS,regex:/miHoYoBBS\/([\d.]+)/i},{name:x.Hoyolab,regex:/miHoYoBBSOversea\/([\d.]+)/i}];t<n.length;t++){var r=n[t],o=e.match(r.regex);if(o){var i=o[1]||void 0;return{environment:r.name,version:i}}}return{environment:"其他",version:void 0}}(),n=t.environment,r=t.version;window.Sentry.setContext("Host",o()({name:n,version:r,isGame:C()},e||{})),window.Sentry.setTags({"host.name":n,"host.version":r||0,"host.sortVersion":m(r),"host.isGame":C()})}},{key:"setUrlQuery",value:function(){var e=P(),t=e.utm_id,n=e.utm_medium,r=e.utm_source,o=function(){var e=window.location.hash;if(!e)return"/";var t=e.split("?");return w()(t,1)[0]}();t&&window.Sentry.setTags({"utm.id":t}),n&&window.Sentry.setTags({"utm.meidum":n}),r&&window.Sentry.setTags({"utm.source":r}),window.Sentry.setTags({hash:o})}},{key:"setUser",value:function(e){e&&(this.user=o()(o()({},this.user),e),this.user._MHYUUID||(this.user._MHYUUID=this.uuid),window.Sentry.setUser(this.user),this.user.accountId&&window.Sentry.setTag("user.accountId",e.accountId),this.user._MHYUUID&&window.Sentry.setTag("user._MHYUUID",e._MHYUUID))}},{key:"initContext",value:function(){this.initUser(),this.setCulture(),this.setBrowser(),this.setHost(),this.setUrlQuery()}},{key:"clearUser",value:function(){var e;e=this.user._MHYUUID?{_MHYUUID:this.user._MHYUUID}:{},this.user=e,window.Sentry.setUser(e)}},{key:"initUser",value:function(){var e=y().getUuid();this.user=o()(o()({},this.user),{},{_MHYUUID:e}),this.setUser(this.user)}},{key:"registerLoginEvent",value:function(){var e=this;this.$accountRoleUtil&&(this.$accountRoleUtil.on("login",(function(t){var n,r;t.isLogin?(e.user=o()(o()({},e.user),{},{display_name:null===(n=t.userInfo)||void 0===n?void 0:n.display_name,accountId:null===(r=t.userInfo)||void 0===r?void 0:r.account_id}),e.setUser(e.user)):e.clearUser()})),this.$accountRoleUtil.on("role",(function(t){var n=t.roleInfo;if(n){var r=n.game_biz,i=n.game_uid,u=n.nickname,s=n.region;e.user=o()(o()({},e.user),{},{gameBiz:r,id:i,nickname:u,region:s}),e.setUser(e.user)}})))}},{key:"registerPaimonEventSentry",value:function(){var e=this;window.PaimonEventSentry&&window.PaimonEventSentry.load().then((function(){e.init()}))}}]),e}(),p()(M.prototype,"setCulture",[b],Object.getOwnPropertyDescriptor(M.prototype,"setCulture"),M.prototype),p()(M.prototype,"setBrowser",[S],Object.getOwnPropertyDescriptor(M.prototype,"setBrowser"),M.prototype),p()(M.prototype,"setHost",[_],Object.getOwnPropertyDescriptor(M.prototype,"setHost"),M.prototype),p()(M.prototype,"setUrlQuery",[U],Object.getOwnPropertyDescriptor(M.prototype,"setUrlQuery"),M.prototype),p()(M.prototype,"setUser",[O],Object.getOwnPropertyDescriptor(M.prototype,"setUser"),M.prototype),p()(M.prototype,"clearUser",[j],Object.getOwnPropertyDescriptor(M.prototype,"clearUser"),M.prototype),M),E=function(e,t){var n=e.prototype.$accountRoleUtil,r=new D({accountRoleUtil:n,lang:t.lang});return e.prototype.$eventSentry={init:r.init},r}},141:function(){},543:function(e,t,n){var r,o,i=n(944).default;!function(u){var s;if(void 0===(o="function"==typeof(r=u)?r.call(t,n,t,e):r)||(e.exports=o),s=!0,"object"===i(t)&&(e.exports=u(),s=!0),!s){var a=window.Cookies,c=window.Cookies=u();c.noConflict=function(){return window.Cookies=a,c}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var u=JSON.stringify(n);/^[\{\[]/.test(u)&&(n=u)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var a in i)i[a]&&(s+="; "+a,!0!==i[a]&&(s+="="+i[a].split(";")[0]));return document.cookie=t+"="+n+s}}function u(e,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],u=0;u<i.length;u++){var s=i[u].split("="),a=s.slice(1).join("=");n||'"'!==a.charAt(0)||(a=a.slice(1,-1));try{var c=t(s[0]);if(a=(r.read||r)(a,c)||t(a),n)try{a=JSON.parse(a)}catch(e){}if(o[c]=a,e===c)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return u(e,!1)},o.getJSON=function(e){return u(e,!0)},o.remove=function(t,n){i(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))}))},547:function(e,t,n){var r,o,i;e=n.nmd(e);var u,s=n(944).default;"undefined"!=typeof self&&self,u=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==s(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n(1))&&r.__esModule?r:{default:r};function i(e){if(window.location.host.indexOf(".mihoyo.com")>-1)o.default.set("_MHYUUID",e,{domain:".mihoyo.com",path:"/",expires:365});else if(window.location.host.indexOf(".hoyolab.com")>-1)o.default.set("_MHYUUID",e,{domain:".hoyolab.com",path:"/",expires:365});else{var t=window.location.hostname.split(".").slice(-2).join(".");o.default.set("_MHYUUID",e,{domain:"."+t,path:"/",expires:365})}}t.default={getVisitorId:function(){var e=this;return new Promise((function(t){t(e.getUuid())}))},getUuid:function(){var e=o.default.get("_MHYUUID");return e?(i(e),e):(i(e=function(){if(window.crypto&&window.crypto.randomUUID)return window.crypto.randomUUID();if(window.crypto&&window.crypto.getRandomValues){var e=new Uint8Array(16);window.crypto.getRandomValues(e),e[6]&=15,e[6]|=64,e[8]&=63,e[8]|=128;var t=Array.prototype.map.call(e,(function(e){return("0"+e.toString(16)).slice(-2)})).join("");return t.substr(0,8)+"-"+t.substr(8,4)+"-4"+t.substr(12,3)+"-"+t.substr(15,4)+"-"+t.substr(19,12)}var n=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(n+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)}))}()),e)}}},function(t,n){t.exports=e}]).default},"object"==s(t)&&"object"==s(e)?e.exports=u(n(543)):(o=[n(543)],void 0===(i="function"==typeof(r=u)?r.apply(t,o):r)||(e.exports=i))},158:function(e){e.exports=function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i},e.exports.__esModule=!0,e.exports.default=e.exports},317:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},180:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},486:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},702:function(e,t,n){var r=n(281);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}e.exports=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},143:function(e,t,n){var r=n(281);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},249:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,u,s=[],a=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},20:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},118:function(e,t,n){var r=n(143);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},5:function(e,t,n){var r=n(166);e.exports=function(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)n=u[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},166:function(e){e.exports=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o},e.exports.__esModule=!0,e.exports.default=e.exports},925:function(e,t,n){var r=n(180),o=n(249),i=n(508),u=n(20);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||u()},e.exports.__esModule=!0,e.exports.default=e.exports},224:function(e,t,n){var r=n(944).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},281:function(e,t,n){var r=n(944).default,o=n(224);e.exports=function(e){var t=o(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},944:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},508:function(e,t,n){var r=n(317);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e};var r={};return function(){"use strict";n.r(r),n.d(r,{Core:function(){return c},EventSentry:function(){return t.Ch},logUtils:function(){return a},mhyEventSentry:function(){return s}});var e=n(704),t=n(576),o=n(141),i={};for(var u in o)["default","EventSentry","mhyEventSentry","logUtils","Core"].indexOf(u)<0&&(i[u]=function(e){return o[e]}.bind(0,u));n.d(r,i),r.default=t.ZP;var s=t.ZP,a=e.ZP,c=t.Ch}(),r}()}));